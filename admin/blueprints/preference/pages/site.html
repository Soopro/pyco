{% extends "layout.html" %}

{% block header %}
<h1>{{_('Site')}}</h1>
{% endblock %}

{% block main %}
<div class="section-body">
  <div class="row">
    <div class="col-12 col-md-6 col-lg-6">
      <div class="card">
        <form action="{{url_for('.update_site')}}"
              method="POST">
          <div class="card-header">
            <h4>{{_('Site Settings')}}</h4>
          </div>
          <div class="card-body">
            <div class="form-group">
              <label>{{_('Site Locale')}}</label>
              <select class="form-control"
                      name="locale">
                {% for lang in site.languages %}
                <option value="{{lang.key}}"
                        {{'selected' if site.locale==lang.key}}>
                  {{lang.name}}
                </option>
                {% endfor %}
              </select>
              <small class="form-text text-muted">
                {{_('* This setting is work for site only.')}}
              </small>
            </div>
            <div class="form-group">
              <label>{{_('Title')}}</label>
              <input class="form-control"
                     type="text"
                     name="title"
                     value="{{site.meta.title}}">
            </div>
            <div class="form-group">
              <label>{{_('Description')}}</label>
              <input class="form-control"
                     type="text"
                     name="description"
                     value="{{site.meta.description}}">
            </div>

            <div class="form-group">
              <label>{{_('Copyright')}}</label>
              <input class="form-control"
                     type="text"
                     name="copyright"
                     value="{{site.meta.copyright}}">
            </div>

            <div class="form-group">
              <label>{{_('License')}}</label>
              <textarea class="form-control"
                        name="license">{{site.meta.license}}</textarea>
            </div>
          </div>
          <div class="card-footer text-right">
            <button class="btn btn-primary">{{_('Save')}}</button>
          </div>
        </form>
      </div>
      <div class="card">
        <form action="{{url_for('.update_site_adv')}}"
              method="POST">
          <div class="card-header">
            <h4>{{_('Advanced Options')}}</h4>
          </div>
          <div class="card-body">
            <div class="form-group">
              <label>{{_('Head Metadata')}}</label>
              <textarea class="form-control"
                        name="head_metadata">{{site.meta.head_metadata}}</textarea>
              <small class="form-text text-muted">
                {{_('* This is usually used in the <head> of the HTML.')}}
              </small>
            </div>
            <div class="form-group">
              <label>{{_('Social Media')}}</label>
              <textarea class="form-control"
                        name="socials"
                        placeholder="[{'figure': 'http://youruploads.com/figure.jpg', 'key': 'github', 'name': 'Github', 'scirpt': '...script', 'url': 'http://yoursocial.com'}]">{{site.meta.socials or ''}}</textarea>
              <small class="form-text text-muted">
                {{_('* For expert only, must use JSON format.')}}
              </small>
            </div>
            <div class="form-group">
              <label>{{_('Languages')}}</label>
              <textarea class="form-control"
                        name="languages"
                        placeholder="[{'key': 'en_US', 'name': 'English', 'url': 'http://en.yoursite.com'}]">{{site.meta.languages or ''}}</textarea>
              <small class="form-text text-muted">
                {{_('* For expert only, must use JSON format.')}}
              </small>
            </div>
          </div>
          <div class="card-footer text-right">
            <button class="btn btn-primary">{{_('Save')}}</button>
          </div>
        </form>
      </div>
    </div>
    <div class="col-12 col-md-6 col-lg-6">
      <div class="card">
        <div class="card-header">
          <h4>{{_('Menu')}}</h4>
        </div>
        <div class="card-body">
          <div class="section-title mt-0">
            {{_('Primary Menu')}}
          </div>
          <div>
            {% if site.menus.primary %}
            {% for item in site.menus.primary %}
            <button class="btn btn-outline-primary w-100 m-1"
                    type="button"
                    data-toggle="modal"
                    data-target="#MODAL-MENU-ITEM"
                    data-name="{{item.name}}"
                    data-link="{{item.link}}"
                    data-window="{{item.target}}"
                    data-fixed="{{item.fixed}}"
                    data-path-scope="{{item.path_scope}}"
                    data-pos="{{loop.index}}"
                    data-parent=""
                    data-action-url="{{url_for('.update_site_menu',
                                               key='primary')}}">
              {{item.name}}
            </button>
            {% endfor %}
            {% endif %}
            <button class="btn btn-secondary w-100 m-1"
                    type="button"
                    data-toggle="modal"
                    data-target="#MODAL-MENU-ITEM-EXPERT"
                    data-hardcore="{{site.menus.primary or ''}}"
                    data-action-url="{{url_for('.hardcore_site_menu',
                                               key='primary')}}">
              {{_('Expert Mode')}}
            </button>
          </div>

          {% for k, v in theme.menus if k != 'primary' %}
          <div class="section-title">
            {{v.title}}
          </div>
          <div>
            {% if site.menus[k] %}
            {% for item in site.menus[k] %}
            <button class="btn btn-outline-primary w-100 m-1"
                    type="button"
                    data-toggle="modal"
                    data-target="#MODAL-MENU-ITEM"
                    data-name="{{item.name}}"
                    data-link="{{item.link}}"
                    data-window="{{item.target}}"
                    data-fixed="{{item.fixed}}"
                    data-path-scope="{{item.path_scope}}"
                    data-pos="{{loop.index}}"
                    data-parent=""
                    data-action-url="{{url_for('.update_site_menu',
                                               key=k)}}">
              {{item.name}}
            </button>
            {% endfor %}
            {% endif %}
            <button class="btn btn-secondary w-100 m-1"
                    type="button"
                    data-toggle="modal"
                    data-target="#MODAL-MENU-ITEM-EXPERT"
                    data-hardcore="{{site.menus[k] or ''}}"
                    data-action-url="{{url_for('.hardcore_site_menu',
                                               key=k)}}">
              {{_('Expert Mode')}}
            </button>
          </div>
          {% endfor %}
        </div>
      </div>
    </div>
  </div>
</div>
{% endblock %}

{% block page_models %}
<div id="MODAL-MENU-ITEM"
     class="modal fade"
     tabindex="-1"
     role="dialog"
     aria-labelledby="{{_('Menu Item')}}"
     aria-hidden="true">
  <div class="modal-dialog" role="exit">
    <div class="modal-content">
      <form action=""
            method="POST">
        <div class="modal-header">
          <h5 class="modal-title">{{_('Menu Item')}}</h5>
          <button class="close"
                  type="button"
                  data-dismiss="modal"
                  aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body">
          <div class="form-group">
            <label>{{_('Name')}}</label>
            <input class="form-control"
                   type="text"
                   name="name"
                   value="">
          </div>
          <div class="form-row">
            <div class="form-group col-md-8">
              <label>{{_('Link')}}</label>
              <input class="form-control"
                     type="text"
                     name="link"
                     value="">
            </div>
            <div class="form-group col-md-4">
              <label>{{_('Target Window')}}</label>
              <input class="form-control"
                     type="text"
                     name="target"
                     placeholder="_self"
                     value="">
            </div>
          </div>

          <div class="form-group">
            <label>{{_('Path Starts With')}}</label>
            <input class="form-control"
                   type="text"
                   name="path_scope"
                   value="">
          </div>

          <div class="form-group">
            <div class="control-label">
              {{_('Fixed Link (No HASH generation)')}}
            </div>
            <label class="custom-switch mt-2">
              <input type="checkbox" name="custom-switch-checkbox" class="custom-switch-input">
              <span class="custom-switch-indicator"></span>
              <span class="custom-switch-description">{{_('Fixed')}}</span>
            </label>
          </div>

          <div class="form-group">
            <label>{{_('Position')}}</label>
            <input class="form-control"
                   type="text"
                   name="_index"
                   value="">
          </div>

          <input type="hidden" name="parent" value="">
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary"
                  data-dismiss="modal">{{_('Dismiss')}}</button>
          <button class="btn btn-primary">
            {{_('Save')}}
          </button>
        </div>
      </form>
    </div>
  </div>
</div>
<div id="MODAL-MENU-ITEM-EXPERT"
     class="modal fade"
     tabindex="-1"
     role="dialog"
     aria-labelledby="{{_('Menu Hardcore')}}"
     aria-hidden="true">
  <div class="modal-dialog" role="exit">
    <div class="modal-content">
      <form action=""
            method="POST">
        <div class="modal-header">
          <h5 class="modal-title">{{_('Menu Hardcore')}}</h5>
          <button class="close"
                  type="button"
                  data-dismiss="modal"
                  aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body">
          <div class="form-group">
            <label>{{_('Hardcore')}}</label>
            <textarea class="form-control"
                      rows="12"
                      name="hardcore"></textarea>
            <small class="form-text text-muted">
              {{_('* For expert only, must use JSON format.')}}
            </small>
          </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary"
                  data-dismiss="modal">{{_('Dismiss')}}</button>
          <button class="btn btn-primary">
            {{_('Save')}}
          </button>
        </div>
      </form>
    </div>
  </div>
</div>
{% endblock %}
{% block page_scripts %}
<script src="{{assets_url}}/modules/jquery-pwstrength/jquery.pwstrength.min.js"></script>
<script src="{{assets_url}}/modules/jquery-selectric/jquery.selectric.min.js"></script>
<script>
$('#MODAL-MENU-ITEM').on('show.bs.modal', function(e) {
  var btn = $(e.relatedTarget);
  var modal = $(e.currentTarget);

  var action_url = btn.data('action-url');

  var item_name = btn.data('name');
  var item_link = btn.data('link');
  var item_target = btn.data('window');
  var item_fixed = btn.data('fixed');
  var item_path_scope = btn.data('path-scope');
  var item_parent = btn.data('parent');

  var pos = btn.data('pos');

  modal.find('input[name="name"]').val(item_name);
  modal.find('input[name="link"]').val(item_link);
  modal.find('input[name="target"]').val(item_target);
  modal.find('input[name="fixed"]').val(item_fixed);
  modal.find('input[name="path_scope"]').val(item_path_scope);
  modal.find('input[name="parent"]').val(item_parent);
  modal.find('input[name="_index"]').val(pos);

});

$('#MODAL-MENU-ITEM-EXPERT').on('show.bs.modal', function(e) {
  var btn = $(e.relatedTarget);
  var modal = $(e.currentTarget);

  var hardcore = btn.data('hardcore');
  modal.find('textarea[name="hardcore"]').val(hardcore);
});
</script>
{% endblock %}